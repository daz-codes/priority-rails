<% content_for :title, @list.name %>
<%= turbo_refreshes_with method: :morph, scroll: :preserve %>
<%= turbo_stream_from @list %>
<% highlight_id = params[:highlight].to_i if params[:highlight] %>

<%= render "title" %>
<%= render "tabs" %>
<%= render "task_form" unless @priority %>

<% if @filter == "completed" %>
<div id="tasks">
    <h3 class="completed_heading">Today</h1>
    <ul class="tasks">
        <%= render @tasks.completed_today %>
    </ul>
    <h3 class="completed_heading">Yesterday</h1>
    <ul class="tasks">
        <%= render @tasks.completed_yesterday %>
    </ul>
    <h3 class="completed_heading">This Week</h3>
    <ul class="tasks">
        <%= render @tasks.completed_this_week %>
    </ul>
    <h3 class="completed_heading">Longer ago ...</h3>
    <ul class="tasks">
        <%= render @tasks.completed_more_than_a_week_ago %>
    </ul>
</div>
<% elsif @tasks.any? %>
    <%= tag.ul id: "tasks",
        class: class_names(priority: @filter == "priority"),
        data: (@filter ? {} : { controller: "sortable tasks highlight-remover", sortable_url_value: sort_tasks_path }) do %>
        <%= render partial: "tasks/task", collection: @tasks, as: :task, locals: { highlight: highlight_id } %>
    <% end %>
<% else %>
  <p id="tasks" class="text-center">No tasks yet!</p>
<% end %>
