<% content_for :title, @list.name %>
<%= turbo_refreshes_with method: :morph, scroll: :preserve %>
<%= turbo_stream_from @list %>
<% highlight_id = params[:highlight].to_i if params[:highlight] %>

<% unless @priority %>
    <section class="hidden sm:block sm:col-start-1 pr-16 pl-4">
        <%= logo %>
        <%= link_to new_list_path, class: "inline-block ml-8 text-white bg-brand-blue border-brand-blue text-sm py-2 px-2 rounded no-underline hover:bg-blue-700" do %>
            <i class="fa-solid fa-square-plus"></i> New List
        <% end %>
    <ul id="lists" class="list-none p-0">
    <%= render @lists %>
    </ul>
    </section>
<% end %>

<section class="col-start-1 sm:col-start-2 min-w-0 overflow-hidden">
<%= render "title" %>
<%= render "tabs" %>
<%= render "task_form" unless @priority %>

<% if @filter == "completed" %>
<div id="tasks">
    <%= render "completed_list", title: "Today", tasks: @tasks.completed_today %>
    <%= render "completed_list", title: "Yesterday", tasks: @tasks.completed_yesterday %>
    <%= render "completed_list", title: "This Week", tasks: @tasks.completed_this_week %>
    <%= render "completed_list", title: "Longer ago ...", tasks: @tasks.completed_more_than_a_week_ago %>
</div>
<% elsif @tasks.any? %>
    <%= tag.ul id: "tasks",
        class: class_names("p-1 list-none", "border-4 border-brand-blue rounded-lg": @filter == "priority"),
        data: (@filter ? {} : { controller: "sortable tasks highlight-remover", sortable_url_value: sort_tasks_path }) do %>
        <%= render partial: "tasks/task", collection: @tasks, as: :task, locals: { highlight: flash[:highlight] } %>
    <% end %>
<% else %>
  <p id="tasks" class="text-center text-brand-grey px-4">No tasks yet!</p>
<% end %>
</section>
