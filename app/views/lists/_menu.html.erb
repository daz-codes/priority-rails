<div id="priority-menu" data-controller="menu" class="relative w-full sm:w-auto sm:inline-block">
  <button data-action="click->menu#toggle" class="font-brand text-3xl w-full sm:w-auto sm:px-12 py-1.5 rounded-full bg-surface-primary border-2 border-border-input hover:border-green-400 hover:bg-green-50 hover:text-black transition-all duration-100 cursor-pointer">
    PR<span class="text-brand-blue">!</span>OR<span class="text-brand-green">!</span>TY<span class="text-brand-red">!</span>
  </button>

  <div data-menu-target="modal" hidden class="fixed left-1/2 -translate-x-1/2 mt-2 w-72 sm:w-[30rem] bg-surface-primary rounded-xl shadow-lg border border-border-primary z-50 overflow-hidden">
    <div class="p-3 border-b border-border-secondary space-y-2">
      <%= link_to new_list_path, class: "flex items-center justify-center gap-2 w-full px-4 py-2 rounded-full bg-green-500 text-white font-semibold text-sm hover:bg-green-600 transition-all duration-100 no-underline" do %>
        <i class="fa-solid fa-plus text-xs"></i> Add New List
      <% end %>
      <input data-menu-target="input"
             data-action="input->menu#filter"
             type="text"
             placeholder="Search lists..."
             class="w-full px-3 py-2 rounded-lg border border-border-primary text-sm focus:outline-none focus:border-green-400 focus:ring-1 focus:ring-green-400">
    </div>

    <ul data-menu-target="listContainer" class="list-none p-0 m-0 max-h-64 overflow-y-auto">
      <%= render partial: "lists/list", collection: Current.user.lists, as: :list, locals: { current_list: @list } %>
    </ul>

    <div class="px-3 pt-3 pb-1 border-t border-border-secondary">
      <div class="flex items-center gap-2 mb-2">
        <span class="text-sm text-text-tertiary truncate flex-1">Signed in as <%= link_to (Current.user.name.presence || Current.user.email_address), edit_account_path, class: "font-semibold text-text-secondary hover:text-text-primary no-underline" %></span>
      </div>
      <div class="flex items-center gap-2">
        <%= button_to session_path, method: :delete, class: "inline-flex flex-1" do %>
          <span class="inline-flex items-center justify-center gap-1.5 w-full px-4 py-1.5 rounded-full border border-border-input text-sm font-semibold text-text-secondary hover:bg-surface-hover hover:text-text-primary transition-all duration-100 cursor-pointer">
            <i class="fa-solid fa-right-from-bracket text-xs"></i> Sign Out
          </span>
        <% end %>
        <button data-action="click->theme#toggle" class="inline-flex items-center justify-center size-9 rounded-full border border-border-input text-text-secondary hover:bg-surface-hover hover:text-text-primary transition-all duration-100 cursor-pointer bg-surface-primary" title="Toggle dark mode">
          <i data-theme-target="icon" class="fa-solid fa-moon text-xs"></i>
        </button>
      </div>
    </div>
  </div>
</div>
