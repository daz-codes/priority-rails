<div id="priority-menu" data-controller="menu" class="relative w-full sm:w-auto sm:inline-block">
  <button data-action="click->menu#toggle" class="font-brand text-3xl w-full sm:w-auto sm:px-12 py-1.5 rounded-full bg-surface-primary border-2 border-border-input hover:border-sky-400 hover:bg-sky-50 hover:text-black transition-all duration-100 cursor-pointer">
    PR<span class="text-brand-blue">!</span>OR<span class="text-brand-green">!</span>TY<span class="text-brand-red">!</span>
  </button>

  <div data-menu-target="modal" hidden class="fixed left-1/2 -translate-x-1/2 mt-2 w-[calc(100vw-2rem)] sm:w-[40rem] bg-surface-primary/95 backdrop-blur-sm rounded-xl shadow-lg border-2 border-border-input z-50 overflow-hidden">
    <div class="p-3 border-b border-border-secondary space-y-2">
      <%= link_to new_list_path, class: "flex items-center justify-center gap-2 w-full px-4 py-2 rounded-full bg-sky-400 text-white font-semibold text-sm hover:bg-sky-500 transition-all duration-100 no-underline" do %>
        <i class="fa-solid fa-plus text-xs"></i> Add New List
      <% end %>
      <input data-menu-target="input"
             data-action="input->menu#filter"
             type="text"
             placeholder="Search lists..."
             class="w-full px-3 py-2 rounded-lg border border-border-primary text-sm focus:outline-none focus:border-sky-400 focus:ring-1 focus:ring-sky-400">
    </div>

    <ul data-menu-target="listContainer" class="list-none p-0 m-0 max-h-64 overflow-y-auto">
      <%= render partial: "lists/list", collection: Current.user.lists, as: :list, locals: { current_list: @list } %>
    </ul>

    <div class="px-3 pt-3 pb-3 border-t border-border-secondary space-y-2">
      <%= link_to about_path, class: "block text-sm text-text-tertiary hover:text-text-secondary no-underline" do %>
        <i class="fa-solid fa-circle-info"></i> About PR!OR!TY!
      <% end %>
      <%= link_to shortcuts_path, class: "block text-sm text-text-tertiary hover:text-text-secondary no-underline" do %>
        <i class="fa-solid fa-keyboard"></i> Keyboard Shortcuts
      <% end %>
      <div class="text-sm text-text-tertiary">Signed in as <span class="font-semibold text-text-secondary"><%= Current.user.name.presence || Current.user.email_address %></span></div>
      <div class="flex gap-2 pt-1">
        <%= link_to edit_account_path, class: "flex-1 inline-flex items-center justify-center gap-1.5 px-4 py-1.5 rounded-full border border-border-input text-sm font-semibold text-text-secondary hover:bg-surface-hover hover:text-text-primary transition-all duration-100 no-underline" do %>
          <i class="fa-solid fa-user-pen text-xs"></i> Edit Profile
        <% end %>
        <%= link_to session_path, data: { turbo_method: :delete }, class: "flex-1 inline-flex items-center justify-center gap-1.5 px-4 py-1.5 rounded-full border border-border-input text-sm font-semibold text-text-secondary hover:bg-surface-hover hover:text-text-primary transition-all duration-100 no-underline cursor-pointer" do %>
          <i class="fa-solid fa-right-from-bracket text-xs"></i> Sign Out
        <% end %>
      </div>
    </div>
  </div>
</div>
